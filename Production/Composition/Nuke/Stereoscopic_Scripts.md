[TOC]

# 立体脚本

本章的标题有点误导，因为Nuke实际上并不局限于立体视图，而是提供对您需要的视图的多视图支持。 视图不一定是立体声对，但由于这是最明显的应用，本章主要涉及立体工程。

# 快速开始

在许多方面，Nuke让您可以像在任何其他图像上一样处理立体素材。 但是，在合成立体素材时，还需要注意几个立体声专用设置和节点。 以下教你如何设置您的立体项目，读入和查看您的图像，使用立体节点，并呈现最终的输出。

以下是工作流程的简要概述：

1. 在Nuke工作立体声镜头的第一步是在项目设置中为他们设置视图（您可以通过在节点图上按**S**来打开项目设置）。 按 **Views 视图** 选项卡上的 **Set up views for stereo 设置为立体视图**进行此操作。 有关详细信息，请参阅设置脚本的视图。

2. 然后，您可以将立体影像素材加载到Nuke中，方法是在文件名字段中输入变量或使用JoinViews节点。 有关详细信息，请参阅[加载多视图图像](#加载多视图图像)。

3. 在查看器中，您可以选择使用视图按钮显示的视图。 您还可以并排显示视图，或者将它们与SideBySide和MixViews节点混合在一起。 有关详细信息，请参阅[在查看器中显示视图]()。

4. 有时你需要修改一个视图，而另一个保持原样。 在这些情况下，您需要使用“视图”菜单拆分视图，或者在RotoPaint的情况下，使用“笔划/形状”列表中的右键单击选项来拆分视图。 有关详细信息，请参阅[选择要应用更改的视图]()。

   如果您需要在两个视图上执行完全不同的操作，则可以将一个视图与OneView节点分开处理。 请参阅[在不同视图上执行不同的操作]()。

5. 如果您有一个差距(disparity)场可用，您还可以使用RotoPaint节点和“**View 视图”**菜单中的相关选项，将对一个视图进行的更改自动复制到另一个视图中。 有关详细信息，请参阅“[对一个视图进行更改]()”。

6. 使用ShuffleViews节点，您可以重新排列视图，并使用Anaglyph节点，您可以将您的素材转换为红色和青色的红青素材。 有关更多信息，请参阅[交换视图]()和[将图像转换为红青浮雕图像]()。

7. 有时您需要重新调整收敛或左右观看摄像机的向内旋转。 当使用3D眼镜查看时，这会更改显示在屏幕深度的图像中的点。 有关更多信息，请参阅[更改收敛]()。

8. 最后，您可以通过动画书渲染出来来预览立体项目的视图。 有关详细信息，请参阅[预览立体图像](#预览立体图像)。

# 加载多视图图像

您可以导入您的素材，让Nuke自动创建视图或在项目设置中提前设置视图。 这允许您单独处理单个视图或两个视图，并查看更改对每个视图的影响。

可能您在几个项目中需要相同的视图，则可以在**template.nk**脚本文件中保存创建的视图。 有关如何执行此操作的更多信息，请参阅[模板脚本](.\Template_Scripts.md)。

### 自动创建视图

> **提示**: 多视图**.mov**文件不实现自动视图创建。 有关如何创建视图的信息，请参阅手动创建和管理视图。

1. 正常读取你的多视图文件。
   **Create missing views?** 对话框显示。

   ![img](.\pic\stereo_create_views_453x82.png)

2. 单击 **Add Views 添加视图**, **Replace Views 替换视图**, 或者 **No**:

   * **Add Views 添加视图** - 将传入剪辑中的视图添加到工程中存在的视图。
   * **Replace Views 替换视图** - 将所有现有工程视图替换为传入剪辑中的所有视图。
   * **No** - 导入剪辑并仅显示文件中的第一个视图，保留项目中的任何现有视图。

您现在可以从某些节点控件的视图下拉菜单中访问工程中的视图。 您还会注意到，每个视图在**Viewer**控件中都有自己的按钮。

### 手动创建和管理视图

1. 选择**Edit** > **Project Settings**。

2. 转到**Views**选项卡。 **Views** 框中列出了可用视图

   ![project_settings_views_tab_5.2_377x253](.\pic\project_settings_views_tab_5.2_377x253.png)

3. 如果要删除名为**main**的视图，并添加**left**和**right**的视图，请单击 **Set up views for stereo 设置立体视图**按钮。 这两个视图被分配颜色。 要更改颜色，请双击颜色字段，然后从打开的颜色选择器中选择另一种颜色。

   ![stereo_colors_changing](.\pic\stereo_colors_changing.png)

   如果您勾选**Use colors in UI? 在UI中使用颜色**，这些颜色将用于节点图连接，节点上的拆分视图指示器以及Viewer和ShuffleViews节点控件，以便更容易区分视图。

   ![joinviews_node](.\pic\joinviews_node.png)

4. 如果要添加其他新视图，请单击+按钮。

5. 在打开的对话框中，输入视图的名称，例如**main**。 单击**OK**。

   ![new_view](.\pic\new_view.png)

6. 根据需要重复步骤4和5，直到获得所需的视图。 您可以通过双击视图名称右侧的区域为所有视图分配颜色。

   ![stereo_colors_assigning_264x145](.\pic\stereo_colors_assigning_264x145.png)

7. 要删除不必要的视图，请从列表中选择视图，然后单击**delete 删除**按钮。 请注意，删除视图不会从脚本中删除对其的引用，并且引用已删除视图的任何节点都会产生错误。

8. 要在视图列表中移动视图，请单击视图面板上方的向上和向下箭头。

9. 要选择加载项目时显示的视图，请将**hero**下拉菜单设置为适当的视图。
   您现在可以从某些节点控件的视图下拉菜单中访问项目中的视图。 您还会注意到，每个视图在**Viewer**控件中都有自己的按钮。

如果创建了许多视图，您可能希望它们显示在下拉菜单中，而不是在查看器和节点控件中单独显示。 要切换到使用下拉菜单， 在**Project Settings 项目设置** 属性面板的 **Views视图** 选项卡中取消选中**View selection uses buttons?  使用按钮选择视图?**。

| ![stereo_buttons](.\pic\stereo_buttons.png) |
| ---------------------------------------- |
| 设置在查看器中选择视图的方式。                          |

# 预览立体图像

您可以使用查看器的立体模式来预览立体图像，也可以使用Nuke的默认动画书来进行动画书渲染。

## 使用查看器的立体模式进行预览

查看器立体声模式允许您一次查看两个视图，以红青浮雕或隔行扫描模式。 要启用查看器的立体模式，请执行以下操作：

1. 右键单击查看器以显示上下文相关菜单。
2. 导航到**Stereo Modes 立体模式**并选择所需的模式：
   *  **Single** - 默认模式, 仅显示使用查看器上方按钮选择的视图。
   *  **Anaglyph** - 使用红青浮雕眼镜观看时会产生3D效果。
   *  **Interlace** - 显示两个视图，但每个扫描线交替。

| ![stereo_mode_anaglyph_265x188](.\pic\stereo_mode_anaglyph_265x188.png) | ![stereo_mode_interlace_265x188](.\pic\stereo_mode_interlace_265x188.png) |
| ---------------------------------------- | ---------------------------------------- |
| 红青浮雕立体模式                                 | 隔行扫描立体模式                                 |

## 动画书渲染立体序列

为了动画书渲染立体图像，请执行以下操作：

1. 选择要动画书渲染的节点。

2. 从主菜单栏中选择 **Render 渲染** > **Flipbook Selected 动画书渲染所选** 选项（或按**Alt** + **F**）。

   您还可以按查看器右下方的**Flipbook this Viewer 动画书渲染此查看器**查看器按钮。 这将对连接到Viewer的节点进行动画书渲染。

   将打开一个对话框。

   ![flipbook_stereo_378x335](D:\Users\zhouxuan.WLF\CloudSync\Notes\Nuke\pic\flipbook_stereo_378x335.png)

3. 在对话框中检查您的设置是否正确。 对话框中的设置与翻转非立体序列时的设置几乎相同。 有关这些设置的更多信息，请参阅[动画书渲染序列]()。

4. 在帧范围输入框中，输入要预览的帧范围（例如，1-35或1-8 10 12-15）。

5. 使用 **Views 视图** 控件，选择要动画书渲染的视图, **left** 或者 **right**。

6. 单击 **OK**。
   Nuke使用脚本设置中定义的帧范围和分辨率将所选视视图呈现为临时序列。 这可能需要一些时间。